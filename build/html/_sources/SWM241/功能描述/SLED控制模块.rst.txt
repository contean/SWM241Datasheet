.. vim: syntax=rst

SLED控制模块（SLED）
--------------

概述
~~

SWM241系列所有型号SLED控制模块操作均相同，不同型号SEG个数可能不同。使用前需使能SLED控制模块时钟。

特性
~~

-  支持1/4占空比或1/8占空比

-  最多8个COM输出引脚和20个SEG输出引脚

-  SLED刷新频率可灵活配置

-  间隔时间可灵活配置

-  灰度时间可灵活配置

模块结构框图
~~~~~~

|SLED控制002|

图 6‑63 SLED控制模块结构框图

功能
~~

本模块为SLED控制器模块，支持1/4占空比或1/8占空比驱动方式。具有最多8个COM输出引脚和20个SEG输出引脚。SLED刷新频率可灵活配置。

SLED每个刷新周期内相关时间配置关系如图 6‑64所示：

|SLED控制003|

图 6‑64 SLED刷新周期内相关时间配置关系图

寄存器映射
~~~~~

.. list-table::
   :widths: 20 20 20 20 20
   :header-rows: 0


   * - 名称   |
     - | 偏移 |
     - |
       |
        |
        |
     - |

        |
        |
     - 描述                       | | | |

   * - SLEDBASE：0 |x400AA800
     - |
     -
     -
     -

   * - CR
     - 0x00
     -
     - 0x 00000
     - SLED控制寄存器             |

   * - CLKDIV
     - 0x04
     -
     - 0x 00008
     - SLED时钟分频寄存器         |

   * - TIM
     - 0x08
     -
     - 0x 000FF
     - SLED刷新时间配置寄存器     |

   * - DATA0
     - 0x10
     -
     - 0x 00000
     - SLED数据0寄存器            |

   * - DATA1
     - 0x14
     -
     - 0x 00000
     - SLED数据1寄存器            |

   * - DATA2
     - 0x18
     -
     - 0x 00000
     - SLED数据2寄存器            |

   * - DATA3
     - 0x1c
     -
     - 0x 00000
     - SLED数据3寄存器            |

   * - DATA4
     - 0x20
     -
     - 0x 00000
     - SLED数据4寄存器            |

   * - DATA5
     - 0x24
     -
     - 0x 00000
     - SLED数据5寄存器            |

   * - DATA6
     - 0x28
     -
     - 0x 00000
     - SLED数据6寄存器            |

   * - DATA7
     - 0x2c
     -
     - 0x 00000
     - SLED数据7寄存器            |


寄存器描述
~~~~~

SLED控制寄存器CR

.. list-table::
   :widths: 20 20 20 20 20
   :header-rows: 0


   * - 寄存器 |
     - | 偏移 |
     - |
       |
         |
     - 复位值 |    描 | |
     - |
            |
              |

   * - CR
     - 0x00
     -
     - 0 000000
     - SLED控制寄存器             |


.. list-table::
   :widths: 12 12 12 12 12 12 12 12
   :header-rows: 0


   * - 31
     - 30
     - 29
     - 28
     - 27
     - 26
     - 25
     - 24

   * - COMINV
     - -
     -
     -
     -
     -
     -
     -

   * - 23
     - 22
     - 21
     - 20
     - 19
     - 18
     - 17
     - 16

   * - -
     -
     -
     -
     -
     -
     -
     -

   * - 15
     - 14
     - 13
     - 12
     - 11
     - 10
     - 9
     - 8

   * - -
     -
     -
     -
     -
     -
     -
     -

   * - 7
     - 6
     - 5
     - 4
     - 3
     - 2
     - 1
     - 0

   * - -
     -
     -
     -
     -
     -
     - DUTY
     - EN


.. list-table::
   :widths: 33 33 33
   :header-rows: 0


   * - 位域 |
     - 名称     | |
     - 描述                                        | |

   * - 31
     - COMINV
     - COM反向配置寄存器                           |

       0：COM波形正常                              |

       1：COM波形反向                              |

   * - 30:2
     - -
     - -

   * - 1
     - DUTY
     - SLED占空比选择                              |

       0：1/4占空比                                |

       1：1/8占空比                                |

   * - 0
     - EN
     - SLED使能控制位                              |

       0：禁止SLED驱动器                           |

       1：使能SLED驱动器                           |


SLED时钟分频寄存器CLKDIV
^^^^^^^^^^^^^^^^^

.. list-table::
   :widths: 20 20 20 20 20
   :header-rows: 0


   * - 寄存器 |
     - | 偏移 |
     - |
       |
         |
     - 复位值 |    描 | |
     - |
            |
              |

   * - CLKDIV
     - 0x04
     -
     - 0 000008
     - SLED时钟分频寄存器         |


.. list-table::
   :widths: 12 12 12 12 12 12 12 12
   :header-rows: 0


   * - 31
     - 30
     - 29
     - 28
     - 27
     - 26
     - 25
     - 24

   * - -
     -
     -
     -
     -
     -
     -
     -

   * - 23
     - 22
     - 21
     - 20
     - 19
     - 18
     - 17
     - 16

   * - -
     -
     -
     -
     -
     -
     -
     -

   * - 15
     - 14
     - 13
     - 12
     - 11
     - 10
     - 9
     - 8

   * - -
     -
     -
     -
     -
     -
     -
     -

   * - 7
     - 6
     - 5
     - 4
     - 3
     - 2
     - 1
     - 0

   * - -
     -
     -
     -
     - DIV
     -
     -
     -


.. list-table::
   :widths: 33 33 33
   :header-rows: 0


   * - 位域 |
     - 名称     | |
     - 描述                                        | |

   * - 31:4
     - -
     - -

   * - 3:0
     - DIV
     - SLED时钟（led_clk）分频寄存器               |

       0000：无效                                  |

       0001：pclk2的2分频                          |

       0010：pclk2的4分频                          |

       0011：pclk2的8分频                          |

       0100：pclk2的16分频                         |

       0101：pclk2的32分频                         |

       0110：pclk2的64分频                         |

       0111：pclk2的128分频                        |

       1000：pclk2的256分频                        |

       1001：pclk2的512分频                        |

       1010：pclk2的1024分频                       |

       1011：pclk2的2048分频                       |

       1100：pclk2的4096分频                       |

       1101：pclk2的8192分频                       |

       1110：pclk2的16384分频                      |

       1111：pclk2的32768分频                      |


SLED刷新时间配置寄存器TIM
^^^^^^^^^^^^^^^^

.. list-table::
   :widths: 20 20 20 20 20
   :header-rows: 0


   * - 寄存器 |
     - | 偏移 |
     - |
       |
         |
     - 复位值 |    描 | |
     - |
            |
              |

   * - TIM
     - 0x08
     -
     - 0 C000FF
     - SLED刷新时间配置寄存器     |


.. list-table::
   :widths: 12 12 12 12 12 12 12 12
   :header-rows: 0


   * - 31
     - 30
     - 29
     - 28
     - 27
     - 26
     - 25
     - 24

   * - -
     -
     -
     -
     -
     -
     - HIGH
     -

   * - 23
     - 22
     - 21
     - 20
     - 19
     - 18
     - 17
     - 16

   * - HIGH
     -
     -
     -
     -
     -
     -
     -

   * - 15
     - 14
     - 13
     - 12
     - 11
     - 10
     - 9
     - 8

   * - -
     -
     -
     -
     -
     -
     - P ERIOD
     -

   * - 7
     - 6
     - 5
     - 4
     - 3
     - 2
     - 1
     - 0

   * - PERIOD
     -
     -
     -
     -
     -
     -
     -


.. list-table::
   :widths: 33 33 33
   :header-rows: 0


   * - 位域 |
     - 名称     | |
     - 描述                                        | |

   * - 31:26
     - -
     - -

   * - 25:16
     - HIGH
     - SLED刷新周期内，COM高电平配置寄存器         |

       high_tim = Tled_clk \* （HIGH+1)            |

       注：LED_HIGH配置值必                        | PERIOD配置值，可用于实现灵活调节显示亮度 |

   * - 15:10
     - -
     - -

   * - 9:0
     - PERIOD
     - SLED刷新周期内，COM/SEG电平周期配置寄存器   |

       period_tim = Tled_clk \*（PERIOD +1）       |


SLED数据x寄存器DATAx（0~7）
^^^^^^^^^^^^^^^^^^^^

.. list-table::
   :widths: 20 20 20 20 20
   :header-rows: 0


   * - 寄存器 |
     - | 偏移 |
     - |
       |
         |
     - 复位值 |    描 | |
     - |
            |
              |

   * - DATA0
     - 0x10
     -
     - 0 000000
     - SLED数据0寄存器            |


.. list-table::
   :widths: 20 20 20 20 20
   :header-rows: 0


   * - 寄存器 |
     - | 偏移 |
     - |
       |
         |
     - 复位值 |    描 | |
     - |
            |
              |

   * - DATA1
     - 0x14
     -
     - 0 000000
     - SLED数据1寄存器            |


.. list-table::
   :widths: 20 20 20 20 20
   :header-rows: 0


   * - 寄存器 |
     - | 偏移 |
     - |
       |
         |
     - 复位值 |    描 | |
     - |
            |
              |

   * - DATA2
     - 0x18
     -
     - 0 000000
     - SLED数据2寄存器            |


.. list-table::
   :widths: 20 20 20 20 20
   :header-rows: 0


   * - 寄存器 |
     - | 偏移 |
     - |
       |
         |
     - 复位值 |    描 | |
     - |
            |
              |

   * - DATA3
     - 0x1c
     -
     - 0 000000
     - SLED数据3寄存器            |


.. list-table::
   :widths: 20 20 20 20 20
   :header-rows: 0


   * - 寄存器 |
     - | 偏移 |
     - |
       |
         |
     - 复位值 |    描 | |
     - |
            |
              |

   * - DATA4
     - 0x20
     -
     - 0 000000
     - SLED数据4寄存器            |


.. list-table::
   :widths: 20 20 20 20 20
   :header-rows: 0


   * - 寄存器 |
     - | 偏移 |
     - |
       |
         |
     - 复位值 |    描 | |
     - |
            |
              |

   * - DATA5
     - 0x24
     -
     - 0 000000
     - SLED数据5寄存器            |


.. list-table::
   :widths: 20 20 20 20 20
   :header-rows: 0


   * - 寄存器 |
     - | 偏移 |
     - |
       |
         |
     - 复位值 |    描 | |
     - |
            |
              |

   * - DATA6
     - 0x28
     -
     - 0 000000
     - SLED数据6寄存器            |


.. list-table::
   :widths: 20 20 20 20 20
   :header-rows: 0


   * - 寄存器 |
     - | 偏移 |
     - |
       |
         |
     - 复位值 |    描 | |
     - |
            |
              |

   * - DATA7
     - 0x2c
     -
     - 0 000000
     - SLED数据7寄存器            |


.. list-table::
   :widths: 12 12 12 12 12 12 12 12
   :header-rows: 0


   * - 31
     - 30
     - 29
     - 28
     - 27
     - 26
     - 25
     - 24

   * - -
     -
     -
     -
     -
     -
     -
     -

   * - 23
     - 22
     - 21
     - 20
     - 19
     - 18
     - 17
     - 16

   * - -
     -
     -
     -
     - SEG19
     - SEG18
     - SEG17
     - SEG16

   * - 15
     - 14
     - 13
     - 12
     - 11
     - 10
     - 9
     - 8

   * - SEG15
     - SEG14
     - SEG13
     - SEG12
     - SEG11
     - SEG10
     - SEG9
     - SEG8

   * - 7
     - 6
     - 5
     - 4
     - 3
     - 2
     - 1
     - 0

   * - SEG7
     - SEG6
     - SEG5
     - SEG4
     - SEG3
     - SEG2
     - SEG1
     - SEG0


.. list-table::
   :widths: 33 33 33
   :header-rows: 0


   * - 位域 |
     - 名称     | |
     - 描述                                        | |

   * - 31:20
     - -
     - -

   * - 19
     - SEG19
     - SEG19数据输出                               |

   * - 18
     - SEG18
     - SEG18数据输出                               |

   * - 17
     - SEG17
     - SEG17数据输出                               |

   * - 16
     - SEG16
     - SEG16数据输出                               |

   * - 15
     - SEG15
     - SEG15数据输出                               |

   * - 14
     - SEG14
     - SEG14数据输出                               |

   * - 13
     - SEG13
     - SEG13数据输出                               |

   * - 12
     - SEG12
     - SEG12数据输出                               |

   * - 11
     - SEG11
     - SEG11数据输出                               |

   * - 10
     - SEG10
     - SEG10数据输出                               |

   * - 9
     - SEG9
     - SEG9数据输出                                |

   * - 8
     - SEG8
     - SEG8数据输出                                |

   * - 7
     - SEG7
     - SEG7数据输出                                |

   * - 6
     - SEG6
     - SEG6数据输出                                |

   * - 5
     - SEG5
     - SEG5数据输出                                |

   * - 4
     - SEG4
     - SEG4数据输出                                |

   * - 3
     - SEG3
     - SEG3数据输出                                |

   * - 2
     - SEG2
     - SEG2数据输出                                |

   * - 1
     - SEG1
     - SEG1数据输出                                |

   * - 0
     - SEG0
     - SEG0数据输出                                |


.. |SLED控制002| image:: media\SLED控制002.emf
.. |SLED控制003| image:: media\SLED控制003.emf
